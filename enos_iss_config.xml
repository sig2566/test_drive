<?xml version="1.0"?>
<root>
<targets_list>

 
  <target
    name="UEP_UTL_14_132_ISS"
	ip="172.16.14.132"
    uid="root"
    passw="root"
    info="UTL test board"
    >
    <prolog>
    	<cmd>'killall ISS.exe'</cmd>
    	<cmd>'cd /opt/uep/apps/'</cmd>
    	<cmd final= "enos login:" timeout_action="new_line">'./AppInit_nicISS'</cmd>
    	<cmd final="Password:">'root'</cmd>
    	<cmd final=".">'admin123'</cmd>
     </prolog>
    <epilog>
    </epilog> 
  </target>
  
  
  
  <target
    name="UEP_TELNET_ISS"
	ip="HOST_IP"
    uid="devops"
    passw="devops123"
    target_ip="TARGET_IP"
    info="Test board in ENOS mode using telnet"
    >
    <prolog>
 	   <cmd final= "login:" timeout_action="new_line">'telnet '+ obj.target_ip</cmd>
     	<cmd final="Password:" timeout_action="new_line">'root'</cmd>
    	<cmd final=".">'admin123'</cmd>  
    </prolog>
    <epilog>
    </epilog> 
  </target>
  
  
 </targets_list> 

<actions_list>

  	<action
		name= "iss_version_test"
		func= "exec_cmdlist"
		>
		<cmd final= "enos|ISS" pass="Hardware Details.*Software Details"> 'show system information'</cmd>
	</action> 

  	<action
		name= "iss_tftp_upgrade_immediate_activate_test"
		func= "exec_cmdlist"
		protocol_ip="tftp://172.16.15.61/"
		bundle_name = "swupdate_uep2025.raucb"
		>
		<cmd final= "#######" pass="Installing .* succeeded" timeout_action="exit" action_delay= "120" 
		> 'firmware download ' + obj.protocol_ip + obj.bundle_name</cmd>
		<cmd final= "Are you sure you want to perform firmware activate procedure?" 
		     >'firmware activate immediate database migrate on'</cmd>		     
			<cmd final="Firmware activate initiated"
			>'Y'</cmd>
	</action> 
	
   	<action
		name= "devel_mode_set"
		func= "exec_cmdlist"
		target="UEP_SERIAL"
		>
		<cmd chk= "True" >'cd /opt/uep/apps'</cmd>
		<cmd final=".">'rm ENOS_MODE'</cmd>		     
		<cmd final=".">'rm ISS_RECOVERY'</cmd>
		<cmd final=".">'reboot ; exit'</cmd>
	</action> 
 	
   	<action
		name= "work_mode_set"
		func= "exec_cmdlist"
		target="UEP_SERIAL"
		>
		<cmd chk= "True" > 'cd /opt/uep/apps'</cmd>
		<cmd final="." > 'touch ENOS_MODE'</cmd>		     
		<cmd final=".">'touch ISS_RECOVERY'</cmd>
		<cmd final="."> 'reboot ; exit' </cmd>
	</action> 
 
 

</actions_list>

<sessions_list>

     <!-- Check system information print  -->
     <session
        name="ISS_VERSION_TST"
        host = "build_VM_61"
        target="UEP_UTL_14_132_ISS"
		timeout= "9600"
        iterations= "1"
         >
        <action>iss_version_test</action>	
        
     </session>    

 	<!-- ISS immideate upgrade from tftp server -->
      <session
        name="ISS_IMMIDEATE_UPGRADE_TFTP_TST"
        host = "build_VM_61"
        target="UEP_UTL_14_132_ISS"
		timeout= "4600"
        iterations= "1"
        sw_update_file="swupdate_utl.rauc"
         >
        <action>iss_tftp_upgrade_immediate_activate_test</action>
        <action>alive_wait</action>	
        <action
          start_time= "180"
		  end_time="190"        
        >random_delay</action>
        <session>ISS_VERSION_TST</session>
     </session>    

 	<!-- ISS immideate upgrade from tftp server -->
      <session
        name="ISS_IMMIDEATE_UPGRADE_TFTP_TST_UEP2025"
		 >
        <session>ISS_IMMIDEATE_UPGRADE_TFTP_TST</session>
    </session>    

     
          <!-- ISS SW update & race condition with reboot test  -->
     <session
        name="LINUX_SW_UPDATE_ISS_RACE_TST_DEVEL"
        host = "build_VM_61"
		timeout= "9600"
		bundle_name = "swupdate_uep2025.raucb"
        iterations= "1"
        >
         <action>devel_mode_set</action>
		 <action>alive_wait</action>			 	        

        <thread_session target="UEP_UTL_14_132"
	        start_time="100"
	        end_time="120"         
	        >RANDOM_DELAY_REBOOT</thread_session>
        <session target="UEP_UTL_14_132_ISS">ISS_IMMIDEATE_UPGRADE_TFTP_TST_UEP2025</session>	
        <session target="UEP_UTL_14_132_ISS"  >ISS_VERSION_TST</session>	
     </session>
   
          <!-- ISS SW update & race condition with reboot test  -->
     <session
        name="LINUX_SW_UPDATE_ISS_RACE_TST_WORK"
 		timeout= "9600"
		bundle_name = "swupdate_uep2025.raucb"
        iterations= "1"
        >
		 <action>work_mode_set</action>
		 <action>alive_wait</action>
		         <action
          start_time= "180"
		  end_time="190"        
        >random_delay</action>
        
        <thread_session target="UEP_UTL_14_132" 
	        start_time="100"
	        end_time="120" port ="2222"        
	        >RANDOM_DELAY_REBOOT</thread_session>
	       
        <session target="UEP_TELNET_ISS">ISS_IMMIDEATE_UPGRADE_TFTP_TST_UEP2025</session>	
        <session target="UEP_TELNET_ISS"  >ISS_VERSION_TST</session>	
     </session>
  
   	<!-- ISS immideate upgrade from tftp server in development mode-->
      <session
        name="ISS_IMMIDEATE_UPGRADE_TFTP_TST_DEV" 
		 >
		 <!--
		 <action>devel_mode_set</action>
		 <action>alive_wait</action>	
		 -->
        <session>ISS_IMMIDEATE_UPGRADE_TFTP_TST</session>
    </session>    
            		
    	<!-- ISS immideate upgrade from tftp server in ENOS + recovery mode-->
      <session
        name="ISS_IMMIDEATE_UPGRADE_TFTP_TST_WORK"
		 >
		 <action>work_mode_set</action>
		 <action>alive_wait</action>
		         <action
          start_time= "180"
		  end_time="190"        
        >random_delay</action>
        <session target="UEP_TELNET_ISS">ISS_IMMIDEATE_UPGRADE_TFTP_TST</session>
    </session>    
            		
 
</sessions_list>
</root>
